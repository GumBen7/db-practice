---
title: Лабораторная работа 4
---


### [Основные типы данных](https://metanit.com/sql/sqlserver/3.3.php)

* Числовые типы данных:
  BIT (от 0 до 16). При значениях до 8 (включительно) занимает 1 байт, от 9 до 16 - 2 байта
    Используется как аналог булевого типа (в этом случае значению true соответствует 1, а значению false - 0)
  TINYINT (от 0 до 255). Занимает 1 байт. Хорошо подходит для хранения небольших чисел
  SMALLINT (от -32768 до 32767). Занимает 2 байта
  INT (от -2147483648 до 2147483647). Занимает 4 байта. Наиболее используемый тип для хранения чисел
  BIGINT (от -9223372036854775808 до 9223372036854775807). Занимает 8 байт
  DECIMAL (числа c фиксированной точностью). Занимает от 5 до 17 байт в зависимости от количества чисел после запятой
    Данный тип может принимать два параметра precision и scale: DECIMAL(precision, scale)
    precision: максимальное количество цифр, которые может хранить число (от 1 до 38, по умолчанию 18)
    scale: максимальное количество цифр после запятой (от 0 до значения параметра precision, по умолчанию оно равно 0)
  NUMERIC: (аналогичен типу DECIMAL)
  SMALLMONEY (дробные значения от -214748.3648 до 214748.3647).Занимает 4 байта. Эквивалентен типу DECIMAL(10,4)
  MONEY (дробные значения от -922337203685477.5808 до 922337203685477.5807). Занимает 8 байт. Эквивалентен типу DECIMAL(19,4)
  FLOAT (от -1.79E+308 до 1.79E+308). Занимает от 4 до 8 байт в зависимости от дробной части
    Может иметь форму определения в виде FLOAT(n), где n - число бит, которые используются для хранения десятичной части числа (мантиссы). По умолчанию n = 53
  REAL (числа от –340E+38 до 3.40E+38). Занимает 4 байта. Эквивалентен типу FLOAT(24)

* Типы данных, представляющие дату и время:
  DATE (дата от 01/01/0001 до 31/12/9999). Занимает 3 байта
  TIME (время в диапазоне от 00:00:00.0000000 до 23:59:59.9999999). Занимает от 3 до 5 байт
    Может иметь форму TIME(n), где n представляет количество цифр от 0 до 7 в дробной части секунд
  DATETIME (дата и время от 01/01/1753 до 31/12/9999). Занимает 8 байт
  DATETIME2 (дата и время от 01/01/0001 00:00:00.0000000 до 31/12/9999 23:59:59.9999999). Занимает от 6 до 8 байт в зависимости от точности времени
     Может иметь форму DATETIME2(n), где n представляет количество цифр от 0 до 7 в дробной части секунд
  SMALLDATETIME (дата и время от 01/01/1900 до 06/06/2079). Занимает от 4 байта.
  DATETIMEOFFSET (дата и время от 01/01/0001 до 31/12/9999). Занимает 10 байт. Сохраняет детальную информацию о времени с точностью до 100 наносекунд

Распространенные форматы дат:
yyyy-mm-dd - 2017-07-12
dd/mm/yyyy - 12/07/2017
mm-dd-yy - 07-12-17 В таком формате двузначные числа от 00 до 49 воспринимаются как даты в диапазоне 2000-2049. А числа от 50 до 99 как диапазон чисел 1950 - 1999.
Month dd, yyyy - July 12, 2017

Распространенные форматы времени:
hh:mi - 13:21
hh:mi am/pm - 1:21 pm
hh:mi:ss - 1:21:34
hh:mi:ss:mmm - 1:21:34:12
hh:mi:ss:nnnnnnn - 1:21:34:1234567

* Строковые типы данных:
  CHAR (фиксированная строка длиной от 1 до 8000 символов). На каждый символ выделяет по 1 байту. Не подходит для многих языков, так как хранит символы не в кодировке Unicode.
    Количество символов, которое может хранить столбец, передается в скобках. Например, для столбца с типом CHAR(10) будет выделено 10 байт.
    И если мы сохраним в столбце строку менее 10 символов, то она будет дополнена пробелами.
  VARCHAR (переменная строка длиной от 1 до 8000 символов). На каждый символ выделяет по 1 байту.
    Можно указать конкретную длину для столбца - от 1 до 8 000 символов, например, VARCHAR(10).
    Если строка должна иметь больше 8000 символов, то задается размер MAX, а на хранение строки может выделяться до 2 Гб: VARCHAR(MAX).
    Не подходит для многих языков, так как хранит символы не в кодировке Unicode.
    В отличие от типа CHAR если в столбец с типом VARCHAR(10) будет сохранена строка в 5 символов, то в столце будет сохранено именно пять символов.
  NCHAR (Unicode – фиксированная строка длиной от 1 до 4000 символов). На каждый символ выделяется 2 байта. Например, NCHAR(15)
  NVARCHAR (Unicode – переменная строка длиной от 1 до 4000 символов). На каждый символ выделяется 2 байта.
    Можно задать конкретный размер от 1 до 4 000 символов. Если строка должна иметь больше 4000 символов, то задается размер MAX, а на хранение строки может выделяться до 2 Гб.
  TEXT и NTEXT (устаревшие, не рекомендуется использовать)
  
* Бинарные типы данных:
  BINARY (фиксированные бинарные данные от 1 до 8000 байт)
  VARBINARY (переменные бинарные данные от 1 до 8000 байт)
  IMAGE (устаревшая, не рекомендуется использовать)

* Другие типы данных:
  UNIQUEIDENTIFIER (уникальный идентификатор GUID). Занимает 16 байт
  TIMESTAMP (номер версии строки в таблице). Занимает 8 байт
  CURSOR (набор строк таблицы)
  HIERARCHYID (позиция в иерархии)
  SQL_VARIANT (данные любого типа)
  XML (документы или фрагменты XML). Занимает в памяти до 2 Гб
  TABLE (определение таблицы)
  GEOGRAPHY (географические данные, такие как широта и долгота)
  GEOMETRY (координаты на плоскости)

---

### Встроенные функции Transact-SQL

Функции SQL производят действия с данными и возвращают результат.

Встроенные функции делятся на три основные группы:
* скалярные функции – обрабатывают одиночное значение и возвращают одно значение. Их можно использовать везде, где допускается применение выражений.
* агрегатные функции – используются для получения обобщающих значений. Они, в отличие от скалярных функций, оперируют значениями столбцов множества строк;
* функции для списка значений.

Скалярные функции бывают следующих категорий:

* строковые функции – выполняют определенные действия над строками и возвращают строковые или числовые значения;
* числовые функции – возвращают числовые значения на основании заданных в аргументе значений того же типа;
* функции времени и даты – выполняют различные действия над входными значениямивремени и даты и возвращают строковое, числовое значение или значение в формате даты и времени;
* функции преобразования типа

---

### Функции для работы со строками


---

### Функции для работы с числами

### Функции для работы с датами и временем

### Функции преобразования данных

### CASE и IIF

### Функции проверки значений

### *Функции NEWID, ISNULL и COALESCE

### SYSDATETIME()

*ALTER TABLE Employees ADD CONSTRAINT DF_Employees_HireDate DEFAULT SYSDATETIME() FOR HireDate

### Ещё

Список часто используемых:

* ISDATE(выражение) - возвращает 1, если выражение имеет допустимое значение типа даты и времени, иначе возвращает значение 0
* ISNUMERIC(выражение) - возвращает 1, если выражение имеет допустимое значение числовой тип данных, иначе возвращает 0
* ISNULL(выражение, замена) - заменяет значение NULL указанным замещающим значением COALESCE(выражение\[,...n ]),
  вычисляет аргументы по порядку и возвращает текущее значение первого выражения, изначально не вычисленного как NULL.

---
